function [Y] = solve_dopri8(X, n, h)
    A = [
        0	0	0	0	0	0	0	0	0	0	0	0
        0.0555556	0	0	0	0	0	0	0	0	0	0	0
        0.0208333	0.0625	0	0	0	0	0	0	0	0	0	0
        0.03125	0	0.09375	0	0	0	0	0	0	0	0	0
        0.3125	0	-1.17188	1.17188	0	0	0	0	0	0	0	0
        0.0375	0	0	0.1875	0.15	0	0	0	0	0	0	0
        0.0479101	0	0	0.112249	-0.0255057	0.0128468	0	0	0	0	0	0
        0.016918	0	0	0.387848	0.0359774	0.19697	-0.172714	0	0	0	0	0
        0.0690958	0	0	-0.634248	-0.161198	0.13865	0.940929	0.211636	0	0	0	0
        0.183557	0	0	-2.46877	-0.291287	-0.026473	2.84784	0.281387	0.123745	0	0	0
        -1.21542	0	0	16.6726	0.915742	-6.05661	-16.0036	14.8493	-13.3716	5.13418	0	0
        0.258861	0	0	-4.77449	-0.435093	-3.04948	5.57792	6.15583	-5.0621	2.19393	0.134628	0
        0.822428	0	0	-11.6587	-0.757622	0.713974	12.0758	-2.12766	1.99017	-0.234286	0.175899	0
        ];

    b = [0.0417475	0	0	0	0	-0.0554523	0.239313	0.703511	-0.75976	0.660563	0.158187	-0.23811	0.25];
    
    Y = zeros(n + 1, 3);
    Y(1, 1:3) = X;

    for j = 2 : n + 1
        k = zeros(length(b), 3);
        for i = 1 : length(k)
            dy = 0;
            for m = 1 : i - 1
                dy = dy + A(i, m) * k(m);
            end
            dy = dy * h;

            k(i, :) = f(Y(j - 1, :) + dy);
        end
        
        dy = zeros(1, 3);
        for i = 1 : length(k)
            dy = dy + k(i, :) * b(i);
        end
        dy = dy * h;

        Y(j, :) = Y(j - 1, :) + dy;
    end
end
